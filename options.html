<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gerrit Jira Tools — 옵션</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; }

    :root {
      --ink-900: #14213d;
      --ink-700: #2f3a54;
      --ink-500: #5f6b87;
      --line: #d7dce8;
      --surface: #ffffff;
      --surface-soft: #f7f9ff;
      --brand: #0f6ad8;
      --brand-strong: #0a4ea5;
      --ok-bg: #ebfff2;
      --ok-fg: #137a3d;
      --err-bg: #fff0f0;
      --err-fg: #be1f2f;
      --info-bg: #edf4ff;
      --info-fg: #0e4f9f;
    }

    body {
      font-family: 'SUIT', 'Pretendard', 'Noto Sans KR', 'Apple SD Gothic Neo', sans-serif;
      max-width: 760px;
      margin: 0 auto;
      padding: 40px 18px 56px;
      color: var(--ink-900);
      background:
        radial-gradient(1100px 620px at 6% -8%, #d7e8ff 0, rgba(215, 232, 255, 0.16) 42%, transparent 70%),
        radial-gradient(1200px 760px at 100% -20%, #ffe8cd 0, rgba(255, 232, 205, 0.14) 36%, transparent 72%),
        linear-gradient(180deg, #f9fbff 0%, #f2f5fd 100%);
    }

    .page-shell {
      background: rgba(255, 255, 255, 0.82);
      border: 1px solid rgba(215, 220, 232, 0.8);
      border-radius: 22px;
      backdrop-filter: blur(2px);
      box-shadow: 0 22px 48px rgba(16, 29, 58, 0.08);
      padding: 24px;
    }

    h1 {
      font-size: 1.52rem;
      font-weight: 700;
      color: var(--ink-900);
      margin: 0;
      letter-spacing: -0.01em;
    }

    .subtitle {
      margin: 8px 0 24px;
      font-size: 0.9rem;
      color: var(--ink-500);
      line-height: 1.65;
    }

    label {
      display: block;
      margin: 20px 0 6px;
      font-weight: 600;
      font-size: 0.86rem;
      color: var(--ink-700);
      letter-spacing: 0.01em;
    }

    input[type="email"],
    input[type="password"] {
      width: 100%;
      padding: 11px 13px;
      border: 1px solid var(--line);
      border-radius: 11px;
      font-size: 0.9rem;
      background: var(--surface);
      color: var(--ink-900);
      transition: border-color 0.18s, box-shadow 0.18s, transform 0.18s;
    }

    input[type="email"]:focus,
    input[type="password"]:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 3px rgba(15, 106, 216, 0.14);
      transform: translateY(-1px);
    }

    .field-note {
      font-size: 0.77rem;
      color: var(--ink-500);
      margin-top: 6px;
    }

    .btn-row {
      display: flex;
      gap: 12px;
      margin-top: 24px;
      flex-wrap: wrap;
    }

    button {
      padding: 10px 18px;
      border: none;
      border-radius: 11px;
      font-size: 0.86rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    button:hover {
      transform: translateY(-1px);
    }

    #btn-save {
      background: linear-gradient(135deg, #1a79ea 0%, var(--brand) 60%, #0f62cb 100%);
      color: #fff;
      box-shadow: 0 9px 18px rgba(15, 106, 216, 0.25);
    }
    #btn-save:hover {
      background: linear-gradient(135deg, #1582ff 0%, #0f6ad8 55%, #0d57b8 100%);
      box-shadow: 0 11px 20px rgba(15, 106, 216, 0.31);
    }

    #btn-test {
      background: #eff3fb;
      color: var(--ink-700);
      border: 1px solid #d9e1f1;
    }
    #btn-test:hover { background: #e7eefc; }
    #btn-test:disabled {
      opacity: 0.55;
      cursor: not-allowed;
      transform: none;
    }

    #status {
      margin-top: 16px;
      min-height: 22px;
      font-size: 0.83rem;
      padding: 9px 12px;
      border-radius: 10px;
      line-height: 1.5;
    }
    #status:empty { padding: 0; }
    #status.ok  { background: var(--ok-bg); color: var(--ok-fg); }
    #status.err { background: var(--err-bg); color: var(--err-fg); }
    #status.inf { background: var(--info-bg); color: var(--info-fg); }

    .section {
      background: var(--surface);
      border: 1px solid var(--line);
      border-radius: 16px;
      padding: 18px;
      margin-top: 20px;
      box-shadow: 0 10px 24px rgba(23, 40, 70, 0.06);
    }
    .section h2 {
      font-size: 0.95rem;
      font-weight: 700;
      margin: 0 0 10px;
      color: var(--ink-900);
      letter-spacing: 0.01em;
    }
    .section ul {
      margin: 0;
      padding-left: 20px;
      font-size: 0.82rem;
      color: var(--ink-700);
      line-height: 1.8;
    }
    .section a {
      color: var(--brand-strong);
    }

    textarea {
      width: 100%;
      padding: 11px 13px;
      border: 1px solid var(--line);
      border-radius: 11px;
      font-size: 0.88rem;
      font-family: 'Consolas', 'Menlo', monospace;
      background: var(--surface);
      color: var(--ink-900);
      resize: vertical;
      min-height: 140px;
      line-height: 1.6;
      transition: border-color 0.15s, box-shadow 0.15s;
    }
    textarea:focus {
      outline: none;
      border-color: var(--brand);
      box-shadow: 0 0 0 3px rgba(15, 106, 216, 0.14);
    }

    .placeholder-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.79rem;
      margin-top: 10px;
    }
    .placeholder-table th {
      text-align: left;
      padding: 7px 8px;
      background: var(--surface-soft);
      color: var(--brand-strong);
      font-weight: 700;
      border-bottom: 1px solid #d7e2f7;
    }
    .placeholder-table td {
      padding: 7px 8px;
      border-bottom: 1px solid #eef1f8;
      color: var(--ink-700);
    }
    .placeholder-table td code {
      background: #eff4ff;
      padding: 1px 5px;
      border-radius: 4px;
      font-size: 0.82rem;
    }

    #btn-reset {
      background: #fff6f6;
      color: #bc2630;
      border: 1px solid #f0c9cf;
      font-size: 0.82rem;
      font-weight: 600;
      padding: 6px 14px;
      margin-top: 8px;
      display: block;
    }
    #btn-reset:hover { background: #ffeef0; border-color: #df9ea7; }

    @media (max-width: 640px) {
      body {
        padding: 16px 10px 28px;
      }

      .page-shell {
        border-radius: 16px;
        padding: 16px;
      }

      h1 {
        font-size: 1.28rem;
      }

      .section {
        padding: 14px;
      }

      .placeholder-table {
        font-size: 0.74rem;
      }
    }
  </style>
</head>
<body>
  <main class="page-shell">
    <h1>Gerrit Jira Tools 옵션</h1>
    <p class="subtitle">Jira 연결 정보와 댓글 템플릿을 설정합니다.</p>

  <label for="email">Jira 이메일</label>
  <input
    type="email"
    id="email"
    placeholder="user@example.com"
    autocomplete="username"
    spellcheck="false"
  >

  <label for="token">Jira API 토큰</label>
  <input
    type="password"
    id="token"
    placeholder="API 토큰을 입력하세요"
    autocomplete="current-password"
    spellcheck="false"
  >
  <div class="field-note">
    API 토큰은 Atlassian 계정에서 발급한 값을 사용하세요.
  </div>

  <div class="btn-row">
    <button id="btn-save">저장</button>
    <button id="btn-test">연결 테스트</button>
  </div>

  <div id="status" role="status" aria-live="polite"></div>

  <div class="section">
    <h2>Jira 댓글 템플릿</h2>
    <p style="font-size:0.8rem;color:#555;margin:0 0 10px;">
      아래 플레이스홀더를 자유롭게 조합하세요. 비워두면 기본값이 사용됩니다.
    </p>

    <table class="placeholder-table">
      <thead>
        <tr><th>플레이스홀더</th><th>치환 내용</th></tr>
      </thead>
      <tbody>
        <tr><td><code>{title}</code></td><td>커밋 제목 (첫 번째 줄)</td></tr>
        <tr><td><code>{body}</code></td><td>커밋 메시지 본문 (제목·jira 라인 제외)</td></tr>
        <tr><td><code>{branch}</code></td><td>타겟 브랜치명</td></tr>
        <tr><td><code>{change_num}</code></td><td>Gerrit change 번호 (예: 12345)</td></tr>
        <tr><td><code>{change_id}</code></td><td>Gerrit Change-Id (예: Iabc123...)</td></tr>
        <tr><td><code>{project}</code></td><td>저장소 경로 (예: platform/myapp)</td></tr>
        <tr><td><code>{owner}</code></td><td>change 작성자 이름</td></tr>
        <tr><td><code>{date}</code></td><td>반영 일시 (submit 시각, 없으면 빈칸)</td></tr>
        <tr><td><code>{url}</code></td><td>Gerrit change 링크 (클릭 가능)</td></tr>
      </tbody>
    </table>

    <label for="template" style="margin-top:14px;">템플릿</label>
    <textarea
      id="template"
      spellcheck="false"
      placeholder="{title}

{body}

브랜치: {branch}
반영 일시: {date}
Gerrit: {url}
Change-Id: {change_id}"
    ></textarea>
    <button id="btn-reset">기본값으로 초기화</button>
  </div>

  <div class="section">
    <h2>도움말</h2>
    <ul>
      <li>
        API 토큰 발급:
        <a
          href="https://id.atlassian.com/manage-profile/security/api-tokens"
          target="_blank"
          rel="noopener noreferrer"
        >Atlassian 계정 설정</a>
        에서 발급하세요.
      </li>
      <li>
        Gerrit change 페이지에서 툴바 아이콘을 클릭하면 popup이 열리며
        이슈 조회/웹링크 추가/코멘트 생성을 실행할 수 있습니다.
      </li>
      <li>
        이슈 키는 change 제목(예: <code>[TF-123] Fix bug</code>) 또는
        커밋 메시지의 <code>jira: TF-123</code> 형식에서 자동 추출됩니다.
      </li>
      <li>
        연결 테스트는 Jira 인증 여부만 확인하며 응답 본문은 읽지 않습니다.
      </li>
    </ul>
  </div>
  </main>

  <script src="message_types.js"></script>
  <script src="options.js"></script>
</body>
</html>
